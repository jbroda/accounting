$(document).ready(function(){function u(){var r=$("#accounts-table").dataTable(),n=[],u,t,i;if($("input[name='accounts']:checked",r.fnGetNodes()).each(function(){n.push(this.value)}),n.length==0)bootbox.dialog({message:"Please select at least one account!",title:"Warning!",buttons:{warning:{label:"OK",className:"btn-danger"}}});else{for(console.log("amount: "+$("#amount").val()),u="Apply '"+$("#memo").val()+"' for "+$("#amount").val()+" dollars on "+$("#date").val()+" to each of the following account(s)?",t="<ul class='two_columns'>",i=0;i<n.length;i++)t+="<li class='two_columns'>"+n[i]+"<\/li>";t+="<\/ul>";bootbox.confirm(u+t,function(t){if(t){console.log("Applying amount "+$("#amount").val()+"...");bootbox.dialog({message:"Updating ...",closeButton:!1});var i=$.ajax({type:"POST",url:"enter/",traditional:!0,data:{amount:$("#amount").val(),memo:$("#memo").val(),category:$("#category").val(),date:$("#date").val(),accounts:n},dataType:"html"});i.done(function(n){var i,u,t;if(console.log("MSG: "+n),n.toLowerCase().indexOf("invalid")>=0){bootbox.hideAll();n=n.replace("INVALID:","");bootbox.alert("Operation failed: "+n);return}for(i=n.split(","),u=0,t=0;t<i.length-1;t++){var e=i[t].split(":"),f=e[0],o=e[1];console.log(f+": "+o);$("#"+f,r.fnGetNodes()).text(o);$("#select_"+f,r.fnGetNodes()).prop("checked",!1);++u}$("#select_all_head").prop("checked",!1);$("#select_all_foot").prop("checked",!1);0==u?(bootbox.hideAll(),bootbox.alert("No accounts were updated!")):location.reload()});i.fail(function(n,t){console.log("failure: "+t);bootbox.hideAll();alert("Request failed: "+t)})}else console.log("Cancelled!")})}}function i(n){var t=!1;return $.each(CHARGE_CATEGORIES,function(i,r){if(i==n)return console.log("isCharge() - "+n+": '"+r+"'"),t=!0,!1}),t}$("#dtpicker").datetimepicker({pickTime:!1});$("#category").change(function(){var n=$("#category").val();$("#amount").val("");$("#memo").val("");$.each(CATEGORIES,function(t,r){if(t==n){if(console.log(n+": '"+r+"'"),i(n)&&$("#memo").val(t+"\r\n"),r!="")try{$("#amount").val(Number(r).toFixed(2))}catch(u){console.log(u);$("#amount").val("Invalid!")}return $("#amount").hide(),$("#amount").slideDown("slow"),$("#amount").focus(),!1}})});$.validator.setDefaults({highlight:function(n){$(n).closest(".form-group").addClass("has-error")},unhighlight:function(n){$(n).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(n,t){t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)}});var n={POSITIVE:"Please enter a postive amount for a charge!",NEGATIVE:"Please enter a negative amount for a payment/credit!"},t=n.POSITIVE,r=function(){return t};$.validator.addMethod("amount_sign",function(r){var u=$("#category").val();return u==""?!0:i(u)?r>0?!0:(t=n.POSITIVE,!1):r>=0?(t=n.NEGATIVE,!1):!0},r);$.validator.addMethod("category_type",function(r){var u=$("#amount").val();return u==""?!0:i(r)?u>0?!0:(t=n.POSITIVE,!1):u>0?(t=n.NEGATIVE,!1):!0},r);$.validator.addMethod("validDate",function(n,t){var i=n,r=!/Invalid|NaN/.test(new Date(i).toString());return this.optional(t)||r},"Please enter a valid date.");$("#entry-form").validate({submitHandler:function(){u()},rules:{amount:{number:!0,required:!0,amount_sign:!0},category:{required:!0,category_type:!0},memo:{required:!0},date:{validDate:!0,required:!0}}})});
//# sourceMappingURL=entry_form.min.js.map
